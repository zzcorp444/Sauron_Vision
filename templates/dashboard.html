<!-- templates/dashboard.html -->
{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-left">
            <img src="{% static 'images/sv_logo_00.png' %}" alt="SV" class="header-logo">
            <h1>SAURON VISION</h1>
        </div>
        <div class="header-center">
            <div class="market-status">
                <span class="status-indicator active"></span>
                <span>MARKET {{ market_status }}</span>
                
                <!-- Market Status Popup -->
                <div class="market-status-popup">
                    <div class="market-group">
                        <h4><i class="fas fa-circle" style="color: var(--primary-text);"></i> Open Markets</h4>
                        <div class="market-list">
                            <div class="market-item open">
                                <span class="market-name">NYSE</span>
                                <span class="market-time">9:30 AM - 4:00 PM EST</span>
                            </div>
                            <div class="market-item open">
                                <span class="market-name">NASDAQ</span>
                                <span class="market-time">9:30 AM - 4:00 PM EST</span>
                            </div>
                            <div class="market-item open">
                                <span class="market-name">London Stock Exchange</span>
                                <span class="market-time">8:00 AM - 4:30 PM GMT</span>
                            </div>
                            <div class="market-item open">
                                <span class="market-name">Crypto (24/7)</span>
                                <span class="market-time">Always Open</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="market-group">
                        <h4><i class="fas fa-circle" style="color: var(--error-text);"></i> Closed Markets</h4>
                        <div class="market-list">
                            <div class="market-item closed">
                                <span class="market-name">Tokyo Stock Exchange</span>
                                <span class="market-time">9:00 AM - 3:00 PM JST</span>
                            </div>
                            <div class="market-item closed">
                                <span class="market-name">Shanghai Exchange</span>
                                <span class="market-time">9:30 AM - 3:00 PM CST</span>
                            </div>
                            <div class="market-item closed">
                                <span class="market-name">Hong Kong Exchange</span>
                                <span class="market-time">9:30 AM - 4:00 PM HKT</span>
                            </div>
                            <div class="market-item closed">
                                <span class="market-name">Sydney Exchange</span>
                                <span class="market-time">10:00 AM - 4:00 PM AEDT</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="header-right">
            <div class="user-info">
                <span>{{ user.user_id }}</span>
                <div class="alerts">
                    <i class="fas fa-bell"></i>
                    <span class="alert-count">{{ active_alerts }}</span>
                </div>
                <div class="activities">
                    <i class="fas fa-tasks"></i>
                    <span class="alert-count">0</span>
                </div>
                <div class="notifs">
                    <i class="fas fa-envelope"></i>
                    <span class="alert-count">0</span>
                </div>
            </div>
            <a href="{% url 'logout' %}" class="logout-btn">
                <i class="fas fa-sign-out-alt"></i>
            </a>
        </div>
    </header>

    <!-- Notice Band -->
    <div class="notice-band">
        <div class="notice-ticker">
            <div class="notice-item">
                <i class="fas fa-bolt"></i>
                <span class="notice-title">Sauron Vision Activity: Analyzing AAPL</span>
                <p class="notice-detail">Pattern detection in progress...</p>
            </div>
            <div class="notice-item">
                <i class="fas fa-globe"></i>
                <span class="notice-title">Global Announcement: Fed Meeting Tomorrow</span>
                <p class="notice-detail">Potential market volatility expected.</p>
            </div>
            <div class="notice-item">
                <i class="fas fa-chart-line"></i>
                <span class="notice-title">Task Update: Backtesting Strategy</span>
                <p class="notice-detail">80% complete.</p>
            </div>
            <div class="notice-item">
                <i class="fas fa-bell"></i>
                <span class="notice-title">New Alert: Volume Spike in TSLA</span>
                <p class="notice-detail">Unusual activity detected.</p>
            </div>
        </div>
    </div>

    <!-- Dashboard Layout -->
    <div class="dashboard-layout">
        <!-- News Intelligence Bar - Behind Sidebar -->
        <div class="news-intelligence-bar" id="news-bar">
            <div class="news-bar-header">
                <div class="news-bar-title">
                    <i class="fas fa-newspaper"></i>
                    <span>Market Intelligence</span>
                </div>
                <div class="news-bar-controls">
                    <button class="news-filter-btn active" data-filter="all">All</button>
                    <button class="news-filter-btn" data-filter="news">News</button>
                    <button class="news-filter-btn" data-filter="social">Social</button>
                    <button class="news-filter-btn" data-filter="analysis">Analysis</button>
                    <button class="news-filter-btn" data-filter="alerts">Alerts</button>
                </div>
            </div>
            
            <div class="news-content">
                <!-- News Items -->
                <div class="news-item" data-type="news">
                    <div class="news-source">
                        <span class="news-source-name">Bloomberg</span>
                        <span class="news-time">2 min ago</span>
                    </div>
                    <h4 class="news-headline">Fed Signals Pause in Rate Hikes as Inflation Shows Signs of Cooling</h4>
                    <p class="news-summary">Federal Reserve officials indicated they may hold interest rates steady in the upcoming meeting...</p>
                    <div class="news-meta">
                        <div class="sentiment-indicator positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>Bullish</span>
                        </div>
                        <div class="social-metrics">
                            <span class="social-metric"><i class="fab fa-twitter"></i> 1.2k</span>
                            <span class="social-metric"><i class="fas fa-comments"></i> 342</span>
                        </div>
                    </div>
                    <div class="news-tags">
                        <span class="news-tag">Fed</span>
                        <span class="news-tag">Rates</span>
                        <span class="news-tag ticker">SPY</span>
                    </div>
                </div>
                
                <div class="news-item" data-type="social">
                    <div class="news-source">
                        <span class="news-source-name">Reddit - WSB</span>
                        <span class="news-time">5 min ago</span>
                    </div>
                    <h4 class="news-headline">Unusual Options Activity Detected on NVDA</h4>
                    <p class="news-summary">Massive call option purchases for NVDA $500 strike...</p>
                    <div class="news-meta">
                        <div class="sentiment-indicator positive">
                            <i class="fas fa-fire"></i>
                            <span>Hot</span>
                        </div>
                        <div class="social-metrics">
                            <span class="social-metric"><i class="fas fa-arrow-up"></i> 5.8k</span>
                        </div>
                    </div>
                    <div class="news-tags">
                        <span class="news-tag ticker">NVDA</span>
                        <span class="news-tag">Options</span>
                    </div>
                </div>
                
                <div class="news-item" data-type="analysis">
                    <div class="news-source">
                        <span class="news-source-name">Sauron AI</span>
                        <span class="news-time">10 min ago</span>
                    </div>
                    <h4 class="news-headline">Pattern Alert: AAPL Ascending Triangle</h4>
                    <p class="news-summary">Bullish pattern formation with 85% success rate...</p>
                    <div class="news-meta">
                        <div class="sentiment-indicator positive">
                            <i class="fas fa-chart-line"></i>
                            <span>Buy Signal</span>
                        </div>
                    </div>
                    <div class="news-tags">
                        <span class="news-tag ticker">AAPL</span>
                        <span class="news-tag">Technical</span>
                    </div>
                </div>
                
                <div class="news-item" data-type="news">
                    <div class="news-source">
                        <span class="news-source-name">Reuters</span>
                        <span class="news-time">15 min ago</span>
                    </div>
                    <h4 class="news-headline">Tesla Q4 Deliveries Beat Estimates</h4>
                    <p class="news-summary">484,507 vehicles delivered, beating expectations...</p>
                    <div class="news-meta">
                        <div class="sentiment-indicator positive">
                            <i class="fas fa-rocket"></i>
                            <span>Bullish</span>
                        </div>
                    </div>
                    <div class="news-tags">
                        <span class="news-tag ticker">TSLA</span>
                        <span class="news-tag">Earnings</span>
                    </div>
                </div>
                
                <!-- More news items... -->
            </div>
        </div>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <button class="sidebar-toggle" id="sidebar-toggle">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <nav class="nav-menu">
                    <a href="#" class="nav-item active" data-section="overview">
                        <i class="fas fa-eye"></i>
                        <span>Overview</span>
                    </a>
                    <a href="#" class="nav-item" data-section="market-scanner">
                        <i class="fas fa-search"></i>
                        <span>Market Scanner</span>
                    </a>
                    <a href="{% url 'vision' %}" class="nav-item">
                        <i class="fas fa-cube"></i>
                        <span>Vision 3D</span>
                    </a>
                    <a href="#" class="nav-item" data-section="strategy-builder">
                        <i class="fas fa-cogs"></i>
                        <span>Strategy Builder</span>
                    </a>
                    <a href="#" class="nav-item" data-section="risk-monitor">
                        <i class="fas fa-shield-alt"></i>
                        <span>Risk Monitor</span>
                    </a>
                    <a href="#" class="nav-item" data-section="sentiment-analysis">
                        <i class="fas fa-brain"></i>
                        <span>Sentiment Analysis</span>
                    </a>
                    <a href="#" class="nav-item" data-section="terminal">
                        <i class="fas fa-terminal"></i>
                        <span>Terminal</span>
                    </a>
                </nav>
            </aside>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Overview Section -->
                <section id="overview" class="content-section active">
                    <div class="section-header">
                        <h2>Market Overview</h2>
                        <div class="section-controls">
                            <button class="control-btn" id="bulk-action-btn">
                                <i class="fas fa-th-large"></i>
                            </button>
                            <button class="control-btn" id="refresh-btn">
                                <i class="fas fa-refresh"></i>
                            </button>
                            <!-- Bulk Action Dropdown -->
                            <div class="bulk-action-dropdown">
                                <button class="bulk-option">Reduce All Cards</button>
                                <button class="bulk-option">Expand All Cards</button>
                                <button class="bulk-option">Add Card</button>
                                <button class="bulk-option">Remove Card</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="overview-grid">
                        <div class="overview-card">
                            <h3>Portfolio Overview</h3>
                            <div class="card-content">
                                <div class="portfolio-grid">
                                    <div class="metric">
                                        <span class="value">$125,847</span>
                                        <span class="label">Total Value</span>
                                    </div>
                                    <div class="metric">
                                        <span class="value">$15,234</span>
                                        <span class="label">Available Cash</span>
                                    </div>
                                    <div class="metric">
                                        <span class="value positive">+2.35%</span>
                                        <span class="label">Today's Change</span>
                                    </div>
                                    <div class="metric">
                                        <span class="value positive">+$2,847</span>
                                        <span class="label">Today's P&L</span>
                                    </div>
                                    <div class="metric">
                                        <span class="value">6</span>
                                        <span class="label">Active Positions</span>
                                    </div>
                                    <div class="metric">
                                        <span class="value warning">Medium</span>
                                        <span class="label">Risk Level</span>
                                    </div>
                                    <div class="metric">
                                        <span class="value">1.15</span>
                                        <span class="label">Portfolio Beta</span>
                                    </div>
                                    <div class="metric">
                                        <span class="value positive">8.7</span>
                                        <span class="label">Portfolio Score</span>
                                    </div>
                                    <div class="metric full-width">
                                        <span class="value">Orders to Market</span>
                                        <span class="label">3 Pending</span>
                                    </div>
                                </div>
                                <div class="card-expanded-content">
                                    <!-- Graphs -->
                                    <div class="portfolio-graph">
                                        <svg class="line-chart">
                                            <polyline points="0,40 20,35 40,30 60,25 80,20 100,15" 
                                                      fill="none" stroke="var(--primary-text)" stroke-width="2"/>
                                        </svg>
                                        <span>Portfolio Value Trend</span>
                                    </div>
                                    <div class="portfolio-pie">
                                        <div class="pie-chart"></div>
                                        <span>Asset Allocation</span>
                                    </div>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>
                        
                        <div class="overview-card">
                            <h3>Active Positions</h3>
                            <div class="card-content">
                                <div class="position-list">
                                    <div class="position-item">
                                        <button class="chart-toggle" onclick="toggleChart(this)">
                                            <i class="fas fa-chevron-down"></i>
                                        </button>
                                        <div class="position-header">
                                            <span class="symbol">AAPL</span>
                                            <span class="value">$150.25</span>
                                            <span class="change positive">+1.25%</span>
                                        </div>
                                        <div class="mini-chart-container">
                                            <div class="mini-chart">
                                                <svg class="chart-svg">
                                                    <polyline class="price-line" points="0,25 15,23 30,20 45,22 60,18 75,16 90,14 100,12" />
                                                    <rect class="volume-bars" x="0" y="26" width="8" height="4" />
                                                    <rect class="volume-bars" x="15" y="24" width="8" height="6" />
                                                    <rect class="volume-bars" x="30" y="25" width="8" height="5" />
                                                    <rect class="volume-bars" x="45" y="23" width="8" height="7" />
                                                    <rect class="volume-bars" x="60" y="26" width="8" height="4" />
                                                    <rect class="volume-bars" x="75" y="24" width="8" height="6" />
                                                    <rect class="volume-bars" x="90" y="25" width="8" height="5" />
                                                </svg>
                                            </div>
                                            <div class="position-data">
                                                <div class="data-row">
                                                    <span class="data-label">Risk:</span>
                                                    <span class="data-value">Low</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Sentiment:</span>
                                                    <span class="data-value">Bullish</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Action:</span>
                                                    <span class="data-value">Hold</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Target:</span>
                                                    <span class="data-value">$165</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chart-info">
                                            <span>1H</span>
                                            <span>Vol: 1.2M</span>
                                        </div>
                                        <div class="position-footer">
                                            <span class="bid-ask">Bid: $150.20 / Ask: $150.30</span>
                                            <button class="details-btn"><i class="fas fa-chart-bar"></i></button>
                                            <button class="order-btn"><i class="fas fa-file-alt"></i></button>
                                        </div>
                                    </div>
                                    
                                    <div class="position-item">
                                        <button class="chart-toggle" onclick="toggleChart(this)">
                                            <i class="fas fa-chevron-down"></i>
                                        </button>
                                        <div class="position-header">
                                            <span class="symbol">GOOGL</span>
                                            <span class="value">$2750.50</span>
                                            <span class="change negative">-0.75%</span>
                                        </div>
                                        <div class="mini-chart-container">
                                            <div class="mini-chart">
                                                <svg class="chart-svg">
                                                    <polyline class="price-line" points="0,8 15,10 30,12 45,10 60,15 75,17 90,19 100,21" />
                                                    <rect class="volume-bars" x="0" y="26" width="8" height="4" />
                                                    <rect class="volume-bars" x="15" y="24" width="8" height="6" />
                                                    <rect class="volume-bars" x="30" y="27" width="8" height="3" />
                                                    <rect class="volume-bars" x="45" y="23" width="8" height="7" />
                                                    <rect class="volume-bars" x="60" y="25" width="8" height="5" />
                                                    <rect class="volume-bars" x="75" y="24" width="8" height="6" />
                                                    <rect class="volume-bars" x="90" y="26" width="8" height="4" />
                                                </svg>
                                            </div>
                                            <div class="position-data">
                                                <div class="data-row">
                                                    <span class="data-label">Risk:</span>
                                                    <span class="data-value">Medium</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Sentiment:</span>
                                                    <span class="data-value">Bearish</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Action:</span>
                                                    <span class="data-value">Watch</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Target:</span>
                                                    <span class="data-value">$2650</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chart-info">
                                            <span>1H</span>
                                            <span>Vol: 850K</span>
                                        </div>
                                        <div class="position-footer">
                                            <span class="bid-ask">Bid: $2750.00 / Ask: $2751.00</span>
                                            <button class="details-btn"><i class="fas fa-chart-bar"></i></button>
                                            <button class="order-btn"><i class="fas fa-file-alt"></i></button>
                                        </div>
                                    </div>
                                    
                                    <div class="position-item">
                                        <button class="chart-toggle" onclick="toggleChart(this)">
                                            <i class="fas fa-chevron-down"></i>
                                        </button>
                                        <div class="position-header">
                                            <span class="symbol">TSLA</span>
                                            <span class="value">$850.75</span>
                                            <span class="change positive">+3.10%</span>
                                        </div>
                                        <div class="mini-chart-container">
                                            <div class="mini-chart">
                                                <svg class="chart-svg">
                                                    <polyline class="price-line" points="0,28 15,25 30,22 45,19 60,16 75,13 90,10 100,7" />
                                                    <rect class="volume-bars" x="0" y="26" width="8" height="4" />
                                                    <rect class="volume-bars" x="15" y="22" width="8" height="8" />
                                                    <rect class="volume-bars" x="30" y="24" width="8" height="6" />
                                                    <rect class="volume-bars" x="45" y="21" width="8" height="9" />
                                                    <rect class="volume-bars" x="60" y="23" width="8" height="7" />
                                                    <rect class="volume-bars" x="75" y="22" width="8" height="8" />
                                                    <rect class="volume-bars" x="90" y="24" width="8" height="6" />
                                                </svg>
                                            </div>
                                            <div class="position-data">
                                                <div class="data-row">
                                                    <span class="data-label">Risk:</span>
                                                    <span class="data-value">High</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Sentiment:</span>
                                                    <span class="data-value">Very Bullish</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Action:</span>
                                                    <span class="data-value">Buy</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Target:</span>
                                                    <span class="data-value">$875</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chart-info">
                                            <span>1H</span>
                                            <span>Vol: 2.5M</span>
                                        </div>
                                        <div class="position-footer">
                                            <span class="bid-ask">Bid: $850.50 / Ask: $851.00</span>
                                            <button class="details-btn"><i class="fas fa-chart-bar"></i></button>
                                            <button class="order-btn"><i class="fas fa-file-alt"></i></button>
                                        </div>
                                    </div>
                                    
                                    <div class="position-item">
                                        <button class="chart-toggle" onclick="toggleChart(this)">
                                            <i class="fas fa-chevron-down"></i>
                                        </button>
                                        <div class="position-header">
                                            <span class="symbol">MSFT</span>
                                            <span class="value">$300.40</span>
                                            <span class="change positive">+0.80%</span>
                                        </div>
                                        <div class="mini-chart-container">
                                            <div class="mini-chart">
                                                <svg class="chart-svg">
                                                    <polyline class="price-line" points="0,20 15,18 30,16 45,18 60,15 75,13 90,11 100,9" />
                                                    <rect class="volume-bars" x="0" y="26" width="8" height="4" />
                                                    <rect class="volume-bars" x="15" y="24" width="8" height="6" />
                                                    <rect class="volume-bars" x="30" y="25" width="8" height="5" />
                                                    <rect class="volume-bars" x="45" y="24" width="8" height="6" />
                                                    <rect class="volume-bars" x="60" y="27" width="8" height="3" />
                                                    <rect class="volume-bars" x="75" y="25" width="8" height="5" />
                                                    <rect class="volume-bars" x="90" y="26" width="8" height="4" />
                                                </svg>
                                            </div>
                                            <div class="position-data">
                                                <div class="data-row">
                                                    <span class="data-label">Risk:</span>
                                                    <span class="data-value">Low</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Sentiment:</span>
                                                    <span class="data-value">Neutral</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Action:</span>
                                                    <span class="data-value">Hold</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Target:</span>
                                                    <span class="data-value">$315</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chart-info">
                                            <span>1H</span>
                                            <span>Vol: 950K</span>
                                        </div>
                                        <div class="position-footer">
                                            <span class="bid-ask">Bid: $300.30 / Ask: $300.50</span>
                                            <button class="details-btn"><i class="fas fa-chart-bar"></i></button>
                                            <button class="order-btn"><i class="fas fa-file-alt"></i></button>
                                        </div>
                                    </div>
                                    
                                    <div class="position-item">
                                        <button class="chart-toggle" onclick="toggleChart(this)">
                                            <i class="fas fa-chevron-down"></i>
                                        </button>
                                        <div class="position-header">
                                            <span class="symbol">NVDA</span>
                                            <span class="value">$450.30</span>
                                            <span class="change positive">+5.20%</span>
                                        </div>
                                        <div class="mini-chart-container">
                                            <div class="mini-chart">
                                                <svg class="chart-svg">
                                                    <polyline class="price-line" points="0,30 15,27 30,24 45,21 60,18 75,15 90,12 100,8" />
                                                    <rect class="volume-bars" x="0" y="26" width="8" height="4" />
                                                    <rect class="volume-bars" x="15" y="20" width="8" height="10" />
                                                    <rect class="volume-bars" x="30" y="19" width="8" height="11" />
                                                    <rect class="volume-bars" x="45" y="18" width="8" height="12" />
                                                    <rect class="volume-bars" x="60" y="21" width="8" height="9" />
                                                    <rect class="volume-bars" x="75" y="20" width="8" height="10" />
                                                    <rect class="volume-bars" x="90" y="22" width="8" height="8" />
                                                </svg>
                                            </div>
                                            <div class="position-data">
                                                <div class="data-row">
                                                    <span class="data-label">Risk:</span>
                                                    <span class="data-value">High</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Sentiment:</span>
                                                    <span class="data-value">Very Bullish</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Action:</span>
                                                    <span class="data-value">Strong Buy</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Target:</span>
                                                    <span class="data-value">$500</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chart-info">
                                            <span>1H</span>
                                            <span>Vol: 4.1M</span>
                                        </div>
                                        <div class="position-footer">
                                            <span class="bid-ask">Bid: $450.20 / Ask: $450.40</span>
                                            <button class="details-btn"><i class="fas fa-chart-bar"></i></button>
                                            <button class="order-btn"><i class="fas fa-file-alt"></i></button>
                                        </div>
                                    </div>
                                    
                                    <div class="position-item">
                                        <button class="chart-toggle" onclick="toggleChart(this)">
                                            <i class="fas fa-chevron-down"></i>
                                        </button>
                                        <div class="position-header">
                                            <span class="symbol">META</span>
                                            <span class="value">$325.60</span>
                                            <span class="change negative">-1.80%</span>
                                        </div>
                                        <div class="mini-chart-container">
                                            <div class="mini-chart">
                                                <svg class="chart-svg">
                                                    <polyline class="price-line" points="0,12 15,14 30,17 45,19 60,22 75,24 90,26 100,28" />
                                                    <rect class="volume-bars" x="0" y="26" width="8" height="4" />
                                                    <rect class="volume-bars" x="15" y="24" width="8" height="6" />
                                                    <rect class="volume-bars" x="30" y="23" width="8" height="7" />
                                                    <rect class="volume-bars" x="45" y="25" width="8" height="5" />
                                                    <rect class="volume-bars" x="60" y="22" width="8" height="8" />
                                                    <rect class="volume-bars" x="75" y="24" width="8" height="6" />
                                                    <rect class="volume-bars" x="90" y="25" width="8" height="5" />
                                                </svg>
                                            </div>
                                            <div class="position-data">
                                                <div class="data-row">
                                                    <span class="data-label">Risk:</span>
                                                    <span class="data-value">Medium</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Sentiment:</span>
                                                    <span class="data-value">Bearish</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Action:</span>
                                                    <span class="data-value">Sell</span>
                                                </div>
                                                <div class="data-row">
                                                    <span class="data-label">Target:</span>
                                                    <span class="data-value">$310</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chart-info">
                                            <span>1H</span>
                                            <span>Vol: 1.5M</span>
                                        </div>
                                        <div class="position-footer">
                                            <span class="bid-ask">Bid: $325.50 / Ask: $325.70</span>
                                            <button class="details-btn"><i class="fas fa-chart-bar"></i></button>
                                            <button class="order-btn"><i class="fas fa-file-alt"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>
                        
                        <div class="signals-overview">
                            <h3>Trading Signals</h3>
                            <div class="card-content">
                                <div class="signals-sections">
                                    <div class="signal-section">
                                        <h4><i class="fas fa-play-circle"></i> Ongoing Signals</h4>
                                        <div class="signal-section-list">
                                            <div class="signal-item">
                                                <div class="signal-header">
                                                    <span class="signal-type buy">BUY</span>
                                                    <span class="signal-symbol">TSLA</span>
                                                    <span class="signal-tier">Tier 3</span>
                                                    <span class="signal-time">Elapsed: 15min</span>
                                                </div>
                                                <div class="signal-details">
                                                    <div class="detail-row">
                                                        <span class="detail-label">Probability:</span>
                                                        <span class="detail-value">85%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Portfolio %:</span>
                                                        <span class="detail-value">5%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Multiplier:</span>
                                                        <span class="detail-value">2x</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. ROI:</span>
                                                        <span class="detail-value">12%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Variation:</span>
                                                        <span class="detail-value">+5%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Timestamps:</span>
                                                        <span class="detail-value">15:00-15:15</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. Hold:</span>
                                                        <span class="detail-value">24h</span>
                                                    </div>
                                                </div>
                                                <div class="signal-actions">
                                                    <button class="execute-btn">Execute Trade</button>
                                                    <button class="delete-btn"><i class="fas fa-trash"></i></button>
                                                </div>
                                            </div>
                                            <div class="signal-item">
                                                <div class="signal-header">
                                                    <span class="signal-type sell">SELL</span>
                                                    <span class="signal-symbol">MSFT</span>
                                                    <span class="signal-tier">Tier 2</span>
                                                    <span class="signal-time">Elapsed: 30min</span>
                                                </div>
                                                <div class="signal-details">
                                                    <div class="detail-row">
                                                        <span class="detail-label">Probability:</span>
                                                        <span class="detail-value">72%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Portfolio %:</span>
                                                        <span class="detail-value">3%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Multiplier:</span>
                                                        <span class="detail-value">1.5x</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. ROI:</span>
                                                        <span class="detail-value">8%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Variation:</span>
                                                        <span class="detail-value">-3%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Timestamps:</span>
                                                        <span class="detail-value">14:30-15:00</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. Hold:</span>
                                                        <span class="detail-value">12h</span>
                                                    </div>
                                                </div>
                                                <div class="signal-actions">
                                                    <button class="execute-btn">Execute Trade</button>
                                                    <button class="delete-btn"><i class="fas fa-trash"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="signal-section">
                                        <h4><i class="fas fa-clock"></i> Forming Set Ups</h4>
                                        <div class="signal-section-list">
                                            <div class="signal-item">
                                                <div class="signal-header">
                                                    <span class="signal-type watch">WATCH</span>
                                                    <span class="signal-symbol">NVDA</span>
                                                    <span class="signal-tier">Tier 4</span>
                                                    <span class="signal-time">Elapsed: 5min</span>
                                                </div>
                                                <div class="signal-details">
                                                    <div class="detail-row">
                                                        <span class="detail-label">Probability:</span>
                                                        <span class="detail-value">78%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Portfolio %:</span>
                                                        <span class="detail-value">4%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Multiplier:</span>
                                                        <span class="detail-value">2.5x</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. ROI:</span>
                                                        <span class="detail-value">15%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Variation:</span>
                                                        <span class="detail-value">+7%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Timestamps:</span>
                                                        <span class="detail-value">15:10-15:15</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. Hold:</span>
                                                        <span class="detail-value">48h</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Pattern:</span>
                                                        <span class="detail-value">Bull Flag</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Confidence:</span>
                                                        <span class="detail-value">75%</span>
                                                    </div>
                                                </div>
                                                <div class="signal-actions">
                                                    <button class="execute-btn">Execute Trade</button>
                                                    <button class="delete-btn"><i class="fas fa-trash"></i></button>
                                                </div>
                                            </div>
                                            <div class="signal-item">
                                                <div class="signal-header">
                                                    <span class="signal-type watch">WATCH</span>
                                                    <span class="signal-symbol">AMD</span>
                                                    <span class="signal-tier">Tier 1</span>
                                                    <span class="signal-time">Elapsed: 10min</span>
                                                </div>
                                                <div class="signal-details">
                                                    <div class="detail-row">
                                                        <span class="detail-label">Probability:</span>
                                                        <span class="detail-value">68%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Portfolio %:</span>
                                                        <span class="detail-value">2%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Multiplier:</span>
                                                        <span class="detail-value">1x</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. ROI:</span>
                                                        <span class="detail-value">5%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Variation:</span>
                                                        <span class="detail-value">+2%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Timestamps:</span>
                                                        <span class="detail-value">15:05-15:15</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. Hold:</span>
                                                        <span class="detail-value">6h</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Pattern:</span>
                                                        <span class="detail-value">Support Test</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Confidence:</span>
                                                        <span class="detail-value">68%</span>
                                                    </div>
                                                </div>
                                                <div class="signal-actions">
                                                    <button class="execute-btn">Execute Trade</button>
                                                    <button class="delete-btn"><i class="fas fa-trash"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="signal-section">
                                        <h4><i class="fas fa-shield-alt"></i> Hedge Signals</h4>
                                        <div class="signal-section-list">
                                            <div class="signal-item">
                                                <div class="signal-header">
                                                    <span class="signal-type hedge">HEDGE</span>
                                                    <span class="signal-symbol">SPY</span>
                                                    <span class="signal-tier">Tier 5</span>
                                                    <span class="signal-time">Elapsed: 20min</span>
                                                </div>
                                                <div class="signal-details">
                                                    <div class="detail-row">
                                                        <span class="detail-label">Probability:</span>
                                                        <span class="detail-value">65%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Portfolio %:</span>
                                                        <span class="detail-value">10%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Multiplier:</span>
                                                        <span class="detail-value">3x</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. ROI:</span>
                                                        <span class="detail-value">-2%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Variation:</span>
                                                        <span class="detail-value">-1%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Timestamps:</span>
                                                        <span class="detail-value">14:55-15:15</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. Hold:</span>
                                                        <span class="detail-value">72h</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Type:</span>
                                                        <span class="detail-value">Put Protection</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Risk Reduction:</span>
                                                        <span class="detail-value">15%</span>
                                                    </div>
                                                </div>
                                                <div class="signal-actions">
                                                    <button class="execute-btn">Execute Trade</button>
                                                    <button class="delete-btn"><i class="fas fa-trash"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="signal-section">
                                        <h4><i class="fas fa-history"></i> Past Signals</h4>
                                        <div class="signal-section-list">
                                            <div class="signal-item">
                                                <div class="signal-header">
                                                    <span class="signal-type buy">BUY</span>
                                                    <span class="signal-symbol">META</span>
                                                    <span class="signal-tier">Tier 4</span>
                                                    <span class="signal-time">Closed +8%</span>
                                                </div>
                                                <div class="signal-details">
                                                    <div class="detail-row">
                                                        <span class="detail-label">Probability:</span>
                                                        <span class="detail-value">82%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Portfolio %:</span>
                                                        <span class="detail-value">6%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Multiplier:</span>
                                                        <span class="detail-value">2x</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. ROI:</span>
                                                        <span class="detail-value">10%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Variation:</span>
                                                        <span class="detail-value">+8%</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Timestamps:</span>
                                                        <span class="detail-value">12:00-15:00</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Est. Hold:</span>
                                                        <span class="detail-value">3 days</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Entry Price:</span>
                                                        <span class="detail-value">$320.00</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Exit Price:</span>
                                                        <span class="detail-value">$345.60</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Profit:</span>
                                                        <span class="detail-value">$2,400</span>
                                                    </div>
                                                    <div class="detail-row">
                                                        <span class="detail-label">Duration:</span>
                                                        <span class="detail-value">3 days</span>
                                                    </div>
                                                </div>
                                                <div class="signal-actions">
                                                    <button class="execute-btn">Execute Trade</button>
                                                    <button class="delete-btn"><i class="fas fa-trash"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>

                        <!-- AI Market Analysis Card -->
                        <div class="overview-card">
                            <h3>AI Market Analysis</h3>
                            <div class="card-content">
                                <div class="ai-insight">
                                    <span class="insight-label">Market Sentiment:</span>
                                    <span class="insight-value positive">Bullish (72%)</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Trend Strength:</span>
                                    <span class="insight-value">Strong Uptrend</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Risk Level:</span>
                                    <span class="insight-value warning">Medium</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Recommended Action:</span>
                                    <span class="insight-value">Hold with trailing stop</span>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>

                        <!-- Performance Metrics Card -->
                        <div class="overview-card">
                            <h3>Performance Metrics</h3>
                            <div class="card-content">
                                <div class="performance-grid">
                                    <div class="metric">
                                        <span class="value positive">+15.7%</span>
                                        <span class="label">YTD Return</span>
                                    </div>
                                    <div class="metric-chart">
                                        <svg class="line-chart">
                                            <polyline points="0,40 20,35 40,30 60,25 80,20 100,15" 
                                                      fill="none" stroke="var(--primary-text)" stroke-width="2"/>
                                        </svg>
                                    </div>
                                    <div class="metric">
                                        <span class="value">1.82</span>
                                        <span class="label">Sharpe Ratio</span>
                                    </div>
                                    <div class="pie-chart"></div>
                                    <div class="metric">
                                        <span class="value">65%</span>
                                        <span class="label">Win Rate</span>
                                    </div>
                                    <div class="metric-chart">
                                        <svg class="line-chart">
                                            <polyline points="0,30 20,28 40,32 60,29 80,25 100,22" 
                                                      fill="none" stroke="var(--warning-text)" stroke-width="2"/>
                                        </svg>
                                    </div>
                                    <div class="metric">
                                        <span class="value negative">-8.3%</span>
                                        <span class="label">Max Drawdown</span>
                                    </div>
                                    <div class="metric">
                                        <span class="value">2.45</span>
                                        <span class="label">Profit Factor</span>
                                    </div>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>
                        
                        <!-- Market Intelligence Overview Card -->
                        <div class="overview-card">
                            <h3>Market Intelligence Overview</h3>
                            <div class="card-content">
                                <div class="ai-insight">
                                    <span class="insight-label">Market Regime:</span>
                                    <span class="insight-value positive">Bull Market</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Volatility Regime:</span>
                                    <span class="insight-value">Low to Medium</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Cross-Asset Signal:</span>
                                    <span class="insight-value positive">Risk-On Environment</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Alternative Data:</span>
                                    <span class="insight-value">Satellite traffic +3.2%</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Dark Pool Activity:</span>
                                    <span class="insight-value warning">Elevated in Tech</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Options Flow:</span>
                                    <span class="insight-value positive">Bullish Bias</span>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>
                        
                        <!-- Sauron's Vision Eye Card -->
                        <div class="overview-card">
                            <h3>Sauron's Vision Eye</h3>
                            <div class="card-content">
                                <div class="ai-insight">
                                    <span class="insight-label">Pattern Recognition:</span>
                                    <span class="insight-value positive">7 Active Patterns</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Anomaly Detection:</span>
                                    <span class="insight-value">2 Market Anomalies</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Predictive Accuracy:</span>
                                    <span class="insight-value positive">78.5% (7 days)</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Vision Confidence:</span>
                                    <span class="insight-value positive">High (0.82)</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Market Transparency:</span>
                                    <span class="insight-value">Full Spectrum Analysis</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Next Major Event:</span>
                                    <span class="insight-value warning">Fed Meeting (3 days)</span>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>

                        <!-- Risk Monitoring Card -->
                        <div class="overview-card">
                            <h3>Risk Monitoring</h3>
                            <div class="card-content">
                                <div class="ai-insight">
                                    <span class="insight-label">VaR:</span>
                                    <span class="insight-value warning">-2.5%</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">CVaR:</span>
                                    <span class="insight-value warning">-3.2%</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Sharpe Ratio:</span>
                                    <span class="insight-value">1.8</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Drawdown:</span>
                                    <span class="insight-value negative">-1.2%</span>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>

                        <!-- Portfolio Management Directives Card -->
                        <div class="overview-card">
                            <h3>Portfolio Management Directives</h3>
                            <div class="card-content">
                                <div class="ai-insight">
                                    <span class="insight-label">Rebalance:</span>
                                    <span class="insight-value">Recommended</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Diversification Score:</span>
                                    <span class="insight-value">7.5/10</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Asset Allocation:</span>
                                    <span class="insight-value">Optimized</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Hedging Status:</span>
                                    <span class="insight-value positive">Active</span>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>

                        <!-- Anomaly Detection Card -->
                        <div class="overview-card">
                            <h3>Anomaly Detection</h3>
                            <div class="card-content">
                                <div class="ai-insight">
                                    <span class="insight-label">Unusual Volume:</span>
                                    <span class="insight-value warning">TSLA</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Price Spike:</span>
                                    <span class="insight-value warning">NVDA</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Correlation Break:</span>
                                    <span class="insight-value">None</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">News Impact:</span>
                                    <span class="insight-value positive">Positive</span>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>

                        <!-- Market Regime Card -->
                        <div class="overview-card">
                            <h3>Market Regime</h3>
                            <div class="card-content">
                                <div class="ai-insight">
                                    <span class="insight-label">Current Regime:</span>
                                    <span class="insight-value positive">Bull</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Volatility:</span>
                                    <span class="insight-value">Low</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Trend:</span>
                                    <span class="insight-value positive">Up</span>
                                </div>
                                <div class="ai-insight">
                                    <span class="insight-label">Regime Shift Prob:</span>
                                    <span class="insight-value">15%</span>
                                </div>
                            </div>
                            <div class="card-controls">
                                <button class="card-more"><i class="fas fa-expand-arrows-alt"></i></button>
                                <button class="card-toggle"><i class="fas fa-arrow-up"></i></button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Terminal Section -->
                <section id="terminal" class="content-section">
                    {% include 'components/terminal.html' %}
                </section>

                <!-- Other sections would be included here -->
            </div>
        </main>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/dashboard.js' %}"></script>
<script>
// Fixed sidebar toggle functionality
document.getElementById('sidebar-toggle').addEventListener('click', function() {
    const sidebar = document.getElementById('sidebar');
    const newsBar = document.getElementById('news-bar');
    
    sidebar.classList.toggle('retracted');
    
    // Toggle news bar visibility
    if (sidebar.classList.contains('retracted')) {
        newsBar.classList.add('visible');
    } else {
        newsBar.classList.remove('visible');
    }
});

// News filter functionality
document.querySelectorAll('.news-filter-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        document.querySelectorAll('.news-filter-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        const filter = this.dataset.filter;
        document.querySelectorAll('.news-item').forEach(item => {
            if (filter === 'all' || item.dataset.type === filter) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        });
    });
});

// Chart toggle functionality
function toggleChart(button) {
    const container = button.parentElement.querySelector('.mini-chart-container');
    const icon = button.querySelector('i');
    
    button.classList.toggle('locked');
    container.classList.toggle('show');
    
    if (button.classList.contains('locked')) {
        icon.className = 'fas fa-chevron-up';
    } else {
        icon.className = 'fas fa-chevron-down';
    }
}

// Make news items clickable
document.querySelectorAll('.news-item').forEach(item => {
    item.addEventListener('click', function() {
        console.log('Opening article...');
    });
});

// Card toggle functionality
document.querySelectorAll('.card-toggle').forEach(btn => {
    btn.addEventListener('click', function() {
        const card = this.closest('.overview-card');
        card.classList.toggle('expanded');
        const icon = this.querySelector('i');
        icon.className = card.classList.contains('expanded') ? 'fas fa-arrow-down' : 'fas fa-arrow-up';
    });
});

// Bulk action dropdown
document.getElementById('bulk-action-btn').addEventListener('click', function() {
    document.querySelector('.bulk-action-dropdown').classList.toggle('show');
});

document.querySelectorAll('.bulk-option').forEach(option => {
    option.addEventListener('click', function() {
        const action = this.textContent.toLowerCase().replace(' all cards', '');
        document.querySelectorAll('.overview-card').forEach(card => {
            if (action === 'reduce') {
                card.classList.remove('expanded');
            } else if (action === 'expand') {
                card.classList.add('expanded');
            }
            // Handle add/remove
        });
    });
});

// Notice band hover
document.querySelectorAll('.notice-item').forEach(item => {
    item.addEventListener('mouseover', function() {
        this.closest('.notice-ticker').style.animationPlayState = 'paused';
        this.querySelector('.notice-detail').style.display = 'block';
    });
    item.addEventListener('mouseout', function() {
        this.closest('.notice-ticker').style.animationPlayState = 'running';
        this.querySelector('.notice-detail').style.display = 'none';
    });
});

// Signal actions
document.querySelectorAll('.signal-item').forEach(item => {
    item.addEventListener('mouseover', function() {
        this.querySelector('.signal-actions').style.display = 'flex';
    });
    item.addEventListener('mouseout', function() {
        this.querySelector('.signal-actions').style.display = 'none';
    });
});

// Notification/Activity/Alert hover popups
['alerts', 'activities', 'notifs'].forEach(className => {
    const icon = document.querySelector(`.${className}`);
    icon.addEventListener('mouseover', function() {
        // Create and show popup
        const popup = document.createElement('div');
        popup.className = 'icon-popup';
        popup.innerHTML = `
            <h4>${className.charAt(0).toUpperCase() + className.slice(1)}</h4>
            <p>Summary of recent ${className}.</p>
            <button>View More</button>
        `;
        document.body.appendChild(popup);
        const rect = icon.getBoundingClientRect();
        popup.style.left = `${rect.left}px`;
        popup.style.top = `${rect.bottom + 10}px`;
    });
    icon.addEventListener('mouseout', function() {
        document.querySelectorAll('.icon-popup').forEach(p => p.remove());
    });
});

// Refresh button
document.getElementById('refresh-btn').addEventListener('click', function() {
    location.reload();
});
</script>
{% endblock %}